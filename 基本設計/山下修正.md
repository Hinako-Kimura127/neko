## 6. 非機能要件 対応方針

### 6.1. 性能

#### レスポンス速度 
 - 各画面の表示は3秒以内を目標とする。商品一覧ページ（画像あり）でも5秒以内を厳守。

#### 同時アクセス数 
 - 同時接続ユーザー数は通常時で最大50人、セール・キャンペーン時には200人程度を想定。

#### データベース応答性 
 - 一般的な検索・登録・更新処理は1秒以内で完了することを目指す。

#### バッチ処理・集計処理
- 夜間バッチ（例：売上集計）は業務開始前（午前6時）までに終了するよう設計する。

#### 対応策
  - 1画面の表示件数を最大20件に制限
  - 大きな画面は適宜縮小し読み込み負荷を軽減
  - 時間がかかる処理は「バッチ処理」としてまとめて実行
  - 商品・ユーザーにインデックスを付与

---

### 6.2. セキュリティ

#### 通信の暗号化  
  - 本番確認や外部アクセスを行う場合は必ず「HTTPS」（SSL/TLS）を利用

#### パスワード管理 
  - パスワードはハッシュ化（bcryptを推奨）して保存。復号不可能な形式とする。

#### CSRF / XSS / SQLインジェクション対策 
  - CSRFトークンを全フォームに付与  
  - 出力時のHTMLエスケープ処理を徹底  
  - SQLを組み立てる際、値を直接文字列連結しない
  - フレームワークを使用し、安全にクエリを実行

#### 管理画面のアクセス制限
  - IP制限、ID・パスワード認証の二重チェックを導入予定
  - URLを直接入力しても403エラーを返す

#### 不正アクセス（URL直接入力）対策
  - 権限を持たないユーザーが他ユーザー用画面に直接URLを入力してアクセスすることを禁止する。 

---

### 6.3. システム環境

#### 利用環境（ユーザーがアクセスする環境）
- ブラウザ  
  - Google Chrome 最新版
- OS  
  - Windows 10 / 11
  - macOS 最新版
  - iOS / Android（スマートフォン対応）

#### 開発環境
- OS  
  - Windows 11
- 開発言語  
  - java等
- フレームワーク  
  - Spring Boot
- バージョン管理  
  - GitHub
- エディタ  
  - Visual Studio Code

#### 実行環境（バックエンド）
- サーバOS  
  - 協議の上、決定
- Webサーバ  
  - 協議の上、決定
- アプリケーションサーバ  
  - 協議の上、決定
- データベース  
  - 協議の上、決定
- 静的ファイル配信  
  - 協議の上、決定
- バッチ処理  
  - 協議の上、決定

#### 実行環境（フロントエンド）
- HTML/CSS/JavaScript
  - 協議の上、決定
- レスポンシブ対応
  - 協議の上、決定

---

### 6.4. 可用性

#### 稼働時間 
  - 稼働率99.5%以上を目標とする。

#### バックアップ
  - データベースは1日1回の自動バックアップを実施。

#### 障害対応
  - エラーログを確認し、問題が起きた時原因を特定しやすいようにする

#### フェールオーバー  
  - 高度な自動切り替えは行わず、単一サーバ構成

---

### 6.5. その他（保守性、運用性、拡張性など）

#### 保守性
  - ソースコードはGitHubでバージョン管理し、mainブランチは常に安定状態を保つ。
  - コードはコメント・ドキュメント含めて可読性を重視した実装とする。

#### 運用性
  - 管理画面から主要情報の登録・編集が可能（商品、カテゴリ、会員情報など）
  - エラーログは管理者がダウンロード・閲覧できる仕組みを用意

#### 拡張性

  - 今後の機能追加（決済機能、レビュー機能など）を想定し、モジュール分割を最低限行う
  - 商品カテゴリ・属性の柔軟な追加を可能にするデータ設計。

---

## 7. 運用・保守設計の概要

### 7.1. ログ設計方針

- **ログの種類と目的**
  - **アクセスログ**：ユーザーアクセス、ページ遷移などの記録（例：Nginx/Apacheログ）
  - **アプリケーションログ**：エラー、例外、重要な処理結果（例：ログイン成功/失敗、注文処理）
  - **（管理操作ログ）[保留]**：商品登録・削除、在庫更新、会員情報更新などの管理者操作を記録

- **出力形式**
  - CSV形式

- **保存期間**
  - アプリケーションログ・アクセスログ：90日間保管（バックアップ含む）
  - 操作ログ：1年間保管（必要に応じて期間延長）

- **閲覧・出力方法**
  - 管理画面からファイルをダウンロードで確認可能にする予定

- **ログフォーマット**: タイムスタンプ、ログレベル、メッセージなど、最低限の情報

---

### 7.2. 監視設計方針

- **監視対象**
  - Webアプリケーション：死活監視（HTTP 200応答）、レスポンス時間監視
  - インフラ（クラウドサーバ）：CPU、メモリ、ディスク使用率
  - データベース：接続数、クエリエラー、ストレージ容量
  - バックアップの実行成否
  - ログイン試行の異常増加（セキュリティ監視）

- **通知方法**
  - 異常検知時にメール／Slack等に自動通知
  - 死活監視の失敗は5分以内にアラート通知

- **対応方針**
  - 監視アラートのレベル分け（Info / Warning / Critical）
  - 重大障害（Critical）については、即時対応・影響調査・復旧報告を実施

---

### 7.3. バックアップ・リカバリ方針

- **バックアップ対象**
  - データベース（商品、会員、注文情報）
  - 商品画像ファイル・管理画面データなどの静的アセット
  - ログファイル（アプリ、Web、セキュリティ）

- **実施頻度**
  - データベース：1日1回の自動バックアップ（フルバックアップ）
  - 必要に応じてリアルタイムのスナップショット対応も検討

- **保管期間**
  - フルバックアップデータは7日間以上保持

- **復旧手順**
  - 障害発生時には最新のバックアップからデータを復旧
  - 業務影響を最小限にするため、リカバリ作業は2〜4時間以内に完了することを目標とする
  - データ復元後、整合性確認・テストを行い、システムの再公開を判断

- **検証体制**
  - 月1回のリカバリ手順確認・テストを実施（手動または自動）


---

### 8.4. スコープ外

-   実際のAPI仕様の細部（例：RESTエンドポイントやリクエスト/レスポンスのJSON構造詳細）
-   単体テスト、結合テストの項目一覧やテストケース詳細
-   詳細な運用保守手順書、障害対応手順書
-   クレジットカード決済機能
-   レビュー投稿機能
-   複雑な在庫管理機能（詳細な在庫数管理、自動引き落としなど）
-   売上管理機能
-   問い合わせフォーム機能（運用体制整備後に検討）
-   監視ツールの活用